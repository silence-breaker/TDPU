# “复旦微电子”企业命题

**一、题目名称：** 基于异构融合架构FPAI的智能创新应用设计

**二、参赛组别：** A组、B组

## 三、赛题背景

随着人工智能技术进入到全面落地应用阶段，端侧智能设备对于高能效、低时延、高灵活性的智能计算需求日益迫切。FPAI异构融合可编程智能芯片，单芯片集成SoC、NPU和FPGA三大核心，具备异构协同、高能效、可扩展、单芯片满足全流程计算需求等优势，已成为端侧人工智能应用的优选解决方案。

本赛题聚焦端侧智能创新应用，旨在充分挖掘FPAI的异构协同计算潜力，将前沿人工智能算法和新兴智能应用部署在FPAI平台上，推动FPAI芯片赋能多元化场景应用落地，解锁端侧智能应用无限可能。

## 四、赛题任务及指标要求

FPAI凭借异构融合架构优势，已广泛应用于智能图像处理、语音识别、智能决策、信号分类等领域。本赛题要求参赛者以复旦微FMQL30TAI-悟净开发板为核心平台，充分发挥FPAI异构协同计算的优势，实现面向具体场景需求的智能应用系统设计实现。具体分为以下两个子任务，要求参赛者从以下两个子任务中选择某一个任务为赛题方向，进行方案设计与实现。

### (二) 任务二：基于30TAI的自定义硬件算子(FPGA IP) 实现

FPAI平台凭借 FPGA的可编程特性，可灵活适应多源传感器接口并高效完成数据采集与预处理。例如，当智能算法的前后处理算子在CPU上实现效率低时，可通过FPGA 进行定制化加速实现。所谓“自定义硬件算子”是通过FPGA对某个计算模块进行电路加速实现，复旦微电子针对目标感知领域的需求，研发了目标检测阈值筛选(DetPost)、语义分割后处理(SegPost)和非极大值抑制(NMS)等自定义硬件算子模块，实现了智能算法的全流程硬件加速，显著提高了计算效率，在多领域项目中实现大规模落地应用。

本任务要求参赛者充分发挥FPAI平台的可编程特性，基于30TAI平台的可编程逻辑资源 (Programmable Logic, PL)，设计并实现一个自定义硬件算子模块，并和CPU、NPU协同工作，完成一个智能算法的部署。

**任务二指标要求：**

1. **基于30TAI平台的可编程逻辑资源，设计并实现一个自定义硬件算子模块。** 该自定义硬件算子为智能算法全流程计算中的一环，包括但不限于以下几种场景：图像拼接融合模块、图像滑窗切图模块、图像缩放模块（任意倍数）、图像 ISP 模块、音频预处理模块、图像格式转换模块、求取连通域模块、特殊算子等。
    
2. **在30TAI平台上，结合自定义硬件算子模块，CPU和NPU，协同实现至少一种智能算法的部署。** 其中，CPU可用于承担部分计算和调度控制任务，NPU 需用于承担矩阵乘/卷积等AI计算任务，自定义硬件算子模块需用于承担前后处理，数据采集或特殊算子等任务。
    
3. **自定义硬件算子功能要具备正确性与完整性**，要求自定义硬件算子能够实现预期功能并能够配合其他计算单元协同完成智能算法全流程部署运行。
    
4. **自定义硬件算子的性能要满足落地应用需求**，要求合理设计、提高硬件资源利用率，尽可能达到最优性能。报告中要分析电路实现相比于CPU 实现的效率提升以及FPGA资源占用情况。
    

**补充说明：**

针对任务二，命题企业会提供一个FPGA示例工程，集成AI_MATE_IP，包括基础接口和互联模块等；配套提供软件端硬件控制和数据传输的驱动函数。参赛者只需要按照接口要求，完成自定义硬件算子模块的设计，以及处理系统中的应用程序即可。

## 2. 任务二评分标准

|项目|内容|分值|评分标准|
|---|---|---|---|
|**方案设计**|自定义硬件算子选择与需求分析|10|重点考察自定义硬件算子的合理性以及实用性，要充分匹配FPAI架构特点。|
||系统结构设计与实现方案 (功能模块划分、接口定义、数据流等)|15|重点考察系统方案设计的可行性、功能模块划分的合理性，数据流与接口定义要清晰合理。|
|**方案实现**|自定义硬件算子模块完成情况，工具链及开发板使用情况 (Icraft, Procise)|15|重点考察自定义硬件算子模块的完成情况，包括实现方案、资源占用情况等。<br><br>重点考察自定义算子单模块是否可实现预期功能。<br><br>充分理解 FPAI架构，正确使用相关工具链及平台。|
||系统功能的正确性与完整性|15|重点考察自定义硬件算子模块是否可与NPU等其他核心协同完成智能算法部署运行。<br><br>与其他外设组合是加分项。|
||系统功能的性能表现与实用性|15|重点考察系统功能的性能表现，要求给出完整的性能分析数据以及优化对比情况。<br><br>考察系统功能是否具备落地应用的价值以及可扩展性。|
|**作品成果**|方案设计与实现文档<br><br>系统集成的软件工程和系统集成的FPGA工程(模型、代码及说明文档)<br><br>汇报PPT|15|方案文档逻辑清晰，格式工整。<br><br>代码格式规范，注释及说明完整，要求结果可复现。<br><br>PPT 条理清晰、重点突出。|
|**现场表现及团队协作**|演示视频及实物演示系统|15|答辩思路清晰，充分理解 FPAI 架构。<br><br>每个团队成员均在项目中发挥重要作用，能力互补。<br><br>实物演示功能正确及性能稳定。|

## 附录：硬件平台介绍

复旦微电子 FMQL30TAI-悟净开发板主要由FMQL30TAI芯片+6颗DDR+外围存储介质+电源+丰富的外设接口构成，为参赛者提供了一个性能强悍的开发平台。

悟净开发板主芯片采用国产全新一代FPAI芯片--FMQL30TAI(以下简称“30TAI”)。该芯片内部集成了4核处理系统(Processing System, PS)，负责系统级控制与通用浮点计算；集成了全新一代诸葛架构神经网络处理器(Neural Processing Unit, NPU)，原生支持 Transformer，负责高效AI计算；集成125K的可编程逻辑(Programmable Logic, PL)，负责传感器数据预处理和定制化功能扩展。通过异构协同机制，30TAI单芯片即可满足端侧智能应用全流程计算需求，包括预处理、AI推理和后处理三个阶段，具备集成度高、小型化、高能效、高可靠性等优势，搭配全自主设计软件工具链 Icraft，可应用于智能传感器、智能算力子卡、可穿戴设备、多模态信息处理等场景。

**30TAI详细技术指标如下表所示：**

|产品名|FMQL30TAI|
|---|---|
|**架构**|诸葛|
|**SoC**|集成4核CPU，主频@1GHz<br><br>VPU支持4K@30FPS 视频编解码|
|**NPU**|集成1个ZG330 iCore，主频@1GHz<br><br>8TOPS@INT8, 4TFLOPS@BF16/FP16, 2TFLOPS@TF32<br><br>iCore 支持 CNN/RNN/Transformer 等神经网络|
|**FPGA**|Logic Cells: 125K, DSP Slices: 400<br><br>Block RAM: 9.3Mb|
|**接口**|PCIE GEN2.0x4, 4路 GTX|
|**DDR支持**|支持DDR3, 速率 1600Mbps<br><br>PS 侧位宽32bit, 1GB<br><br>PL侧位宽64bit, 4GB|
|**封装**|FCBGA676, 27*27|
|**功耗**|约8W|

关于悟净开发板更多信息，请从“3.开发资源”章节中的网站中进行获取。

## 2. 开发工具要求

(1) NPU开发工具：Icraft (2) FPGA开发工具：Procise

## 3. 开发资源

(1) 关注公众号“国产FPGA之家”，获取更多相关资源及教程
(2) 软件工具链等相关资源下载地址：https://university-program.fdwxhb.com/
(3) 算法部署教程及模型库：https://gitee.com/mxh-spiger